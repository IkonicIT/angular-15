<div class="animated fadeIn">
  <div class="row">
    <div class="col-lg-12">
      <div class="card">
        <div class="card-body">
          <div class="form-group col-sm-12 text-right">
            <button
              type="button"
              (click)="print()"
              tooltip="Click to Print this Page"
              class="btn btn-outline-danger btn-sm btn-right"
            >
              Print
            </button>
            <button
              type="button"
              (click)="help()"
              tooltip=" Instructions"
              class="btn btn-outline-danger btn-sm"
            >
              Help
            </button>
            <div
              style="
                text-align: left;
                border: 1px solid;
                width: fit-content;
                background-color: whitesmoke;
              "
              *ngIf="helpFlag == true"
            >
              * To create a Note <br />
              1.Enter the information <br />
              2.Click the 'Save' button <br />
              * Pressing 'Cancel' will undo the changes you've made.
            </div>
          </div>
          <p class="card-text" style="font-weight: bold; font-size: 22px">
            Vendor Notes:
          </p>

          <div *ngIf="newFlag == true">
            <div class="row">
              <div class="form-group col-sm-12 text-right">
                <button
                  [disabled]="highestRank < 6"
                  type="button"
                  class="btn btn-primary btn-right"
                  tooltip="Add New Vendor Note"
                  (click)="addNotes()"
                >
                  New
                </button>
                <button
                  [disabled]="highestRank < 6"
                  type="button"
                  tooltip="Save Vendor Note"
                  (click)="saveVendorNotes()"
                  class="btn btn-primary btn-right"
                >
                  Save
                </button>
                <button
                  *ngIf="highestRank > 5"
                  type="button"
                  tooltip="Cancel the Changes for this Note"
                  (click)="backToVendor()"
                  class="btn btn-primary btn-right"
                >
                  Cancel
                </button>
                <button
                  type="button"
                  class="btn btn-primary btn-right"
                  tooltip="Delete Vendor Note"
                  disabled
                  (click)="openModal(confirmtemplate, model.vendorNoteId)"
                >
                  Delete
                </button>
                <button
                  type="button"
                  tooltip=" Add Vendor Note Attachment"
                  class="btn btn-primary btn-right"
                  disabled
                  (click)="goToAttachments(model.vendorNoteId)"
                >
                  Attachments
                </button>
                <button
                  type="button"
                  tooltip="Back"
                  (click)="backToVendor()"
                  class="btn btn-primary btn-right"
                >
                  Back
                </button>
              </div>
            </div>
            <alert
              *ngIf="index1 == 1"
              type="success"
              [dismissible]="dismissible"
            >
              Note was successfully Saved
            </alert>
            <alert
              *ngIf="index1 == 2"
              type="success"
              [dismissible]="dismissible"
            >
              Note was successfully Updated
            </alert>

            <alert
              type="danger"
              *ngIf="index1 == -1"
              [dismissible]="dismissible"
            >
              Please Enter Title and Date
            </alert>

            <alert
              type="success"
              *ngIf="index1 == 4"
              [dismissible]="dismissible"
            >
              Note was successfully Deleted
            </alert>

            <div class="row">
              <div class="form-group col-sm-6">
                <label for="title"
                  >Title <strong class="text-danger">*</strong></label
                >
                <input
                  type="text"
                  [(ngModel)]="model.vendorNoteId"
                  name="vendorNoteId"
                  #vendorNoteId="ngModel"
                  id="_id"
                  hidden
                />
                <input
                  class="form-control"
                  type="text"
                  class="form-control"
                  [(ngModel)]="model.name"
                  name="title"
                  #title="ngModel"
                  id="title"
                  placeholder="Enter Title"
                />
              </div>
              <div class="form-group col-sm-6">
                <label for="date"
                  >Date <strong class="text-danger">*</strong></label
                >
                <input
                  type="text"
                  class="form-control"
                  [(ngModel)]="model.createdDate"
                  name="date"
                  #date="ngModel"
                  id="date"
                  placeholder="Enter Date"
                  bsDatepicker
                />
              </div>
            </div>

            <div class="row">
              <div class="form-group col-sm-6">
                <label for="job">JOB Number</label>
                <input
                  type="text"
                  class="form-control"
                  [(ngModel)]="model.jobNumber"
                  name="job"
                  #job="ngModel"
                  id="job"
                  placeholder="Enter JOB Number"
                />
              </div>
              <div class="form-group col-sm-6">
                <label for="po">PO Number</label>
                <input
                  type="text"
                  class="form-control"
                  [(ngModel)]="model.poNumber"
                  id="po"
                  name="po"
                  #po="ngModel"
                  placeholder="Enter PO Number"
                />
              </div>
            </div>

            <div class="row">
              <div class="form-group col-sm-12">
                <label for="details">Details</label>
                <textarea
                  id="details"
                  name="textarea-input"
                  rows="2"
                  cols="4"
                  name="details"
                  #details="ngModel"
                  class="form-control"
                  [(ngModel)]="model.details"
                  placeholder="Enter Description"
                ></textarea>
              </div>
            </div>
          </div>

          <div *ngIf="viewFlag == true">
            <div class="row">
              <div class="form-group col-sm-12 text-right">
                <p style="text-align: left">
                  <strong>Viewing Vendor Note'</strong>
                </p>
                <button
                  [disabled]="highestRank < 6"
                  type="button"
                  class="btn btn-primary btn-right"
                  tooltip="Add New Vendor Note"
                  (click)="addNotes()"
                >
                  New
                </button>
                <button
                  type="button"
                  tooltip="Save Vendor Note"
                  disabled
                  class="btn btn-primary btn-right"
                >
                  Save
                </button>
                <button
                  [disabled]="highestRank < 6"
                  type="button"
                  class="btn btn-primary btn-right"
                  tooltip="Edit vendor Note"
                  (click)="editNote()"
                >
                  Edit
                </button>

                <button
                  type="button"
                  class="btn btn-primary btn-right"
                  tooltip="Delete Vendor Note"
                  disabled
                  (click)="openModal(confirmtemplate, model.vendorNoteId)"
                >
                  Delete
                </button>
                <button
                  [disabled]="highestRank < 6"
                  type="button"
                  tooltip=" Add Vendor Note Attachment"
                  class="btn btn-primary btn-right"
                  (click)="goToAttachments(model.vendorNoteId)"
                >
                  Attachments
                </button>
                <button
                  type="button"
                  tooltip="Back"
                  (click)="backToVendor()"
                  class="btn btn-primary btn-right"
                >
                  Back
                </button>
              </div>
            </div>
            <alert
              *ngIf="index1 == 1"
              type="success"
              [dismissible]="dismissible"
            >
              Note for Vendor was successfully Saved
            </alert>
            <alert
              *ngIf="index1 == 2"
              type="success"
              [dismissible]="dismissible"
            >
              Note for 'Vendor: -- ' was successfully Updated
            </alert>

            <alert
              type="danger"
              *ngIf="index1 == -1"
              [dismissible]="dismissible"
            >
              Please Enter Title and Date
            </alert>

            <alert
              type="success"
              *ngIf="index1 == 4"
              [dismissible]="dismissible"
            >
              Note for Vendor was successfully Deleted
            </alert>

            <div class="row">
              <div class="form-group col-sm-6">
                <label for="title"
                  >Title <strong class="text-danger">*</strong></label
                >
                <input
                  type="text"
                  class="form-control backgroundColor"
                  [(ngModel)]="model.vendorNoteId"
                  name="vendorNoteId"
                  #vendorNoteId="ngModel"
                  id="_id"
                  hidden
                />
                <input
                  readonly
                  class="form-control backgroundColor"
                  type="text"
                  [(ngModel)]="model.name"
                  name="title"
                  #title="ngModel"
                  id="title"
                  placeholder="Enter Title"
                />
              </div>
              <div class="form-group col-sm-6">
                <label for="date"
                  >Date <strong class="text-danger">*</strong></label
                >
                <input
                  readonly
                  class="form-control backgroundColor"
                  type="text"
                  [(ngModel)]="model.createdDate"
                  name="date"
                  #date="ngModel"
                  id="date"
                />
              </div>
            </div>

            <div class="row">
              <div class="form-group col-sm-6">
                <label for="job">JOB Number</label>
                <input
                  readonly
                  type="text"
                  class="form-control backgroundColor"
                  [(ngModel)]="model.jobNumber"
                  name="job"
                  #job="ngModel"
                  id="job"
                  placeholder="Enter JOB Number"
                />
              </div>
              <div class="form-group col-sm-6">
                <label for="po">PO Number</label>
                <input
                  readonly
                  type="text"
                  class="form-control backgroundColor"
                  [(ngModel)]="model.poNumber"
                  id="po"
                  name="po"
                  #po="ngModel"
                  placeholder="Enter PO Number"
                />
              </div>
            </div>

            <div class="row">
              <div class="form-group col-sm-12">
                <label for="details">Details</label>
                <textarea
                  readonly
                  id="details"
                  name="textarea-input"
                  rows="2"
                  cols="4"
                  name="details"
                  #details="ngModel"
                  class="form-control backgroundColor"
                  [(ngModel)]="model.details"
                  placeholder="Enter Description"
                ></textarea>
              </div>
            </div>
          </div>

          <div *ngIf="editFlag == true">
            <div class="row">
              <div class="form-group col-sm-12 text-right">
                <p style="text-align: left">
                  <strong>Editing Vendor Note</strong>
                </p>
                <button
                  [disabled]="highestRank < 6"
                  type="button"
                  class="btn btn-primary btn-right"
                  tooltip="Add New Vendor Note"
                  (click)="addNotes()"
                  style="border-radius: 6px;"
                >
                  New
                </button>
                <button
                  [disabled]="highestRank < 6"
                  type="button"
                  tooltip="Save Vendor Note"
                  (click)="updateVendorNotes()"
                  class="btn btn-primary btn-right"
                  style="border-radius: 6px;"
                >
                  Update
                </button>

                <button
                  *ngIf="highestRank > 5"
                  type="button"
                  tooltip="Cancel the Changes for this Note"
                  (click)="backToVendor()"
                  class="btn btn-primary btn-right"
                  style="border-radius: 6px;"
                >
                  Cancel
                </button>
                <button
                  [disabled]="highestRank < 6 || highestRank == 9"
                  type="button"
                  class="btn btn-primary btn-right"
                  tooltip="Delete Vendor Note"
                  (click)="openModal(confirmtemplate, model.vendorNoteId)"
                  style="border-radius: 6px;"
                >
                  Delete
                </button>
                <button
                  [disabled]="highestRank < 6"
                  type="button"
                  tooltip=" Add Vendor Note Attachment"
                  class="btn btn-primary btn-right"
                  style="border-radius: 6px;"
                  (click)="goToAttachments(model.vendorNoteId)"
                >
                  Attachments
                </button>
                <button
                  type="button"
                  tooltip="Back"
                  (click)="backToVendor()"
                  class="btn btn-primary btn-right"
                  style="border-radius: 6px;"
                >
                  Back
                </button>
              </div>
            </div>
            <alert
              *ngIf="index1 == 1"
              type="success"
              [dismissible]="dismissible"
            >
              Note for 'Vendor: -- ' was successfully Saved
            </alert>
            <alert
              *ngIf="index1 == 2"
              type="success"
              [dismissible]="dismissible"
            >
              Note for 'Vendor: -- ' was successfully Updated
            </alert>

            <alert
              type="danger"
              *ngIf="index1 == -1"
              [dismissible]="dismissible"
            >
              Please Enter Title and Date
            </alert>

            <alert
              type="success"
              *ngIf="index1 == 4"
              [dismissible]="dismissible"
            >
              Note for 'Vendor: -- ' was successfully Deleted
            </alert>

            <div class="row">
              <div class="form-group col-sm-6">
                <label for="title"
                  >Title <strong class="text-danger">*</strong></label
                >
                <input
                  type="text"
                  [(ngModel)]="model.vendorNoteId"
                  name="vendorNoteId"
                  #vendorNoteId="ngModel"
                  id="_id"
                  hidden
                />
                <input
                  readonly
                  type="text"
                  class="form-control backgroundColor"
                  [(ngModel)]="model.name"
                  name="title"
                  #title="ngModel"
                  id="title"
                  placeholder="Enter Title"
                />
              </div>
              <div class="form-group col-sm-6">
                <label for="date"
                  >Date <strong class="text-danger">*</strong></label
                >

                <input
                  type="text"
                  class="form-control"
                  [(ngModel)]="model.createdDate"
                  name="date"
                  #date="ngModel"
                  id="date"
                />
              </div>
            </div>

            <div class="row">
              <div class="form-group col-sm-6">
                <label for="job">JOB Number</label>
                <input
                  type="text"
                  class="form-control"
                  [(ngModel)]="model.jobNumber"
                  name="job"
                  #job="ngModel"
                  id="job"
                  placeholder="Enter JOB Number"
                />
              </div>
              <div class="form-group col-sm-6">
                <label for="po">PO Number</label>
                <input
                  type="text"
                  class="form-control"
                  [(ngModel)]="model.poNumber"
                  id="po"
                  name="po"
                  #po="ngModel"
                  placeholder="Enter PO Number"
                />
              </div>
            </div>

            <div class="row">
              <div class="form-group col-sm-12">
                <label for="details">Details</label>
                <textarea
                  id="details"
                  name="textarea-input"
                  rows="2"
                  cols="4"
                  name="details"
                  #details="ngModel"
                  class="form-control"
                  [(ngModel)]="model.details"
                  placeholder="Enter Description"
                ></textarea>
              </div>
            </div>
          </div>

          <div class="animated fadeIn" *ngIf="highestRank > 4">
            <!--/.row-->
            <div class="row">
              <div class="col-lg-12">
                <p class="card-text" style="font-weight: bold; font-size: 18px">
                  Current Notes:
                </p>
                <!-- Large modal -->
                <div class="card-body">
                  <div>
                    <div class="float-left">
                      <span
                        >Show
                        <select [(ngModel)]="itemsForPagination">
                          <option>5</option>
                          <option>10</option>
                          <option>25</option>
                          <option>50</option>
                        </select>
                        entries
                      </span>
                    </div>
                  </div>
                  <div class="float-right div-search">
                    <span>Search : </span>
                    <input [(ngModel)]="vendorNotesFilter" />
                  </div>
                  <table
                    class="table table-responsive-sm table-hover table-outline mb-0"
                  >
                    <thead class="thead-light">
                      <tr>
                        <th
                          [class.active]="order === 'createdDate'"
                          (click)="setOrder('createdDate')"
                        >
                          Date<span [hidden]="reverse == ''">▼</span
                          ><span [hidden]="reverse != ''">▲</span>
                        </th>
                        <th
                          [class.active]="order === 'name'"
                          (click)="setOrder('name')"
                        >
                          Title<span [hidden]="reverse == ''">▼</span
                          ><span [hidden]="reverse != ''">▲</span>
                        </th>
                        <th
                          [class.active]="order === 'jobNumber'"
                          (click)="setOrder('jobNumber')"
                        >
                          Job<span [hidden]="reverse == ''">▼</span
                          ><span [hidden]="reverse != ''">▲</span>
                        </th>
                        <th
                          [class.active]="order === 'poNumber'"
                          (click)="setOrder('poNumber')"
                        >
                          PO<span [hidden]="reverse == ''">▼</span
                          ><span [hidden]="reverse != ''">▲</span>
                        </th>
                        <th
                          [class.active]="order === 'createdBy'"
                          (click)="setOrder('createdBy')"
                        >
                          By <span [hidden]="reverse == ''">▼</span
                          ><span [hidden]="reverse != ''">▲</span>
                        </th>

                        <th>Actions</th>
                      </tr>
                    </thead>

                    <tbody>
                      <tr
                        *ngFor="
                          let note of notes
                            | orderBy : reverse + order
                            | filterBy
                              : [
                                  'createdDate',
                                  'name',
                                  'jobNumber',
                                  'poNumber',
                                  'createdBy'
                                ]
                              : vendorNotesFilter
                            | paginate
                              : {
                                  itemsPerPage: itemsForPagination,
                                  currentPage: p
                                }
                        "
                      >
                        <td>{{ note.createdDate | date : "MM/dd/yyyy" }}</td>
                        <td>{{ note.name }}</td>
                        <td>{{ note.jobNumber }}</td>
                        <td>{{ note.poNumber }}</td>
                        <td>{{ note.createdBy }}</td>
                        <!-- <td>
                          <ng-container *ngFor="let attachment of note.attachmentList">
                            <br><a href="javascript:void(0)" tooltip="Click here to View this NoteAttachment"
                              (click)="download(attachment)">{{attachment.fileName}}</a>
                          </ng-container>
                        </td> -->

                        <td>
                          <button
                            type="button"
                            class="btn btn-outline-danger btn-sm"
                            tooltip="Click here to View this Note"
                            (click)="viewVendorNote(note.vendorNoteId)"
                          >
                            View
                          </button>
                        </td>
                      </tr>
                    </tbody>
                  </table>
                  <pagination-controls
                    class="my-pagination"
                    (pageChange)="p = $event"
                    [autoHide]="true"
                  >
                  </pagination-controls>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <ng-template #confirmtemplate>
    <div class="modal-body text-center">
      <p>
        Click(Yes) to permanently delete this Note or Click(No) to discard this
        action.
      </p>
      <button
        type="button"
        class="btn btn-primary btn-right"
        (click)="confirm()"
      >
        Yes
      </button>
      <button
        type="button"
        class="btn btn-primary btn-right"
        (click)="decline()"
      >
        No
      </button>
    </div>
  </ng-template>
</div>
